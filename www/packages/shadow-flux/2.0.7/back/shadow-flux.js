!function(t){var e={};function i(s){if(e[s])return e[s].exports;var n=e[s]={i:s,l:!1,exports:{}};return t[s].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=e,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(s,n,function(e){return t[e]}.bind(null,n));return s},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=1)}([function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.constantTree=function t(e,i=""){for(let s in e){const n=`${i}${""!==i?".":""}${s}`;"string"==typeof e[s]&&0===e[s].length?e[s]=n:"object"==typeof e[s]&&t(e[s],n)}return e}},function(t,e,i){"use strict";var s=this&&this.__awaiter||function(t,e,i,s){return new(i||(i=Promise))(function(n,r){function o(t){try{c(s.next(t))}catch(t){r(t)}}function a(t){try{c(s.throw(t))}catch(t){r(t)}}function c(t){t.done?n(t.value):new i(function(e){e(t.value)}).then(o,a)}c((s=s.apply(t,e||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0});const n=i(2),r=i(7);n.connect(class{constructor(){}entryPoint(t){return s(this,void 0,void 0,function*(){yield t.Service.registerService("shadow-flux","com.shadow",{serviceDefinition:r})})}})},function(t,e,i){"use strict";var s=this&&this.__awaiter||function(t,e,i,s){return new(i||(i=Promise))(function(n,r){function o(t){try{c(s.next(t))}catch(t){r(t)}}function a(t){try{c(s.throw(t))}catch(t){r(t)}}function c(t){t.done?n(t.value):new i(function(e){e(t.value)}).then(o,a)}c((s=s.apply(t,e||[])).next())})},n=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var i in t)Object.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e.default=t,e};Object.defineProperty(e,"__esModule",{value:!0});const r=i(3);e.BaseComponent=r.BaseComponent;const o=n(i(5));e.UtilEnv=o;const a=n(i(0));e.UtilConstant=a;const c=i(6);e.Ioc=c.Ioc,e.connect=function(t){return s(this,void 0,void 0,function*(){yield _nucleus(t)})}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(4);e.BaseComponent=class{constructor(){this.cmpId="",this.cmpName="",this.getService=void 0}_send(t,e){this._evtBus&&this._evtBus.emitAsync(t,e)}_sendWithReturn(t,e,i){return new Promise((n,r)=>{this._evtBus?(this._evtBus.once(e,t=>{n(t)}),this._evtBus.emitAsync(t,i)):r(Error(s.Errors.TECHNICAL.EVENTBUS_IS_NOT_DEFINED))})}_Receive(t,e){return this._evtBus?this._evtBus.on(t,e):{off:()=>void 0}}_ReceiveOnce(t,e){return this._evtBus?this._evtBus.once(t,e):{off:()=>void 0}}get identity(){return{cmpId:this.cmpId,cmpName:this.cmpName}}initialize(){}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});let s=i(0).constantTree({TYPE:{TECHNICAL:"",BUSINESS:""},TECHNICAL:{EVENTBUS_IS_NOT_DEFINED:""}});e.Errors=s},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.isNode=function(){return"[object process]"===Object.prototype.toString.call("undefined"!=typeof process?process:0)}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Ioc=function(t){return function(e){e.prototype.__nc__Services=t}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const s=i(8);e.Dispatcher=s.Dispatcher;const n=i(13);e.BaseStore=n.BaseStore;const r=i(15);e.Subscriber=r.Subscriber},function(t,e,i){"use strict";var s=this&&this.__awaiter||function(t,e,i,s){return new(i||(i=Promise))(function(n,r){function o(t){try{c(s.next(t))}catch(t){r(t)}}function a(t){try{c(s.throw(t))}catch(t){r(t)}}function c(t){t.done?n(t.value):new i(function(e){e(t.value)}).then(o,a)}c((s=s.apply(t,e||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0});const n=i(9),r=i(10),o=i(11),a=i(12);e.Dispatcher=class{constructor(){this.debug={setDebugOn:()=>{this.debugHelper.setDebugState(!0)},setDebugOff:()=>{this.debugHelper.setDebugState(!1)},lockState:t=>{this._debugMode&&this._stores.forEach(e=>this._eventBus.emit(`${e.id}.lockState`,t))},getFrameLength:()=>this.debugHelper.countUpdates(),goToFrame:t=>{this._debugCycle&&(this._debugCycle.frameIndex=t)},playCurrentFrame:()=>{this._debugCycle&&this._debugCycle.playCurrentFrame()}},this.debugHelper={setDebugState:t=>{this._debugMode=t,t?!this._debugCycle&&(this._debugCycle=new a.DispatcherCycle(this)):this._debugCycle&&(this._debugCycle._events.length=0,this._debugCycle=null)},countUpdates:()=>this._debugCycle?this._debugCycle.length:0},this._payloads=[],this._stores=[],this._storeHash={},this._isDispatching=!1,this._currentStoreTab={},this._eventBus=new o.EventBus,this._debugCycle=null,this._debugMode=!1,this._currentFrame=null,this._eventBus.on("allEvents",t=>{this._debugCycle&&this._debugCycle.newEvent(t.eventName,t.data)})}waitFor(...t){return s(this,void 0,void 0,function*(){const e=t.map(t=>this._currentStoreTab[t].getPromise());yield Promise.all(e)})}processNextPayload(){this._debugMode&&this._isDispatching&&this._debugCycle&&this._debugCycle.newEvent("dispatcher.endCycle",null);const t=this._payloads.shift();if(!t)return void(this._isDispatching=!1);this._debugMode&&this._debugCycle&&this._debugCycle.newEvent("dispatcher.newCycle",null),this._isDispatching=!0;const e=this._stores.map(e=>{const i=this,s=new r.DefferedPromise((s,n)=>{e.dispatchHandler(t,()=>{s()},()=>{s()},i.waitFor.bind(i))});return this._currentStoreTab[e.id]=s,s});this._debugMode&&this._debugCycle&&this._debugCycle.newEvent("dispatcher.dispatch",t),Promise.all(e.map(t=>t.getPromise())).then(()=>{this._currentStoreTab={},this._payloads.length>0?this.processNextPayload():(this._debugMode&&this._debugCycle&&this._debugCycle.newEvent("dispatcher.endCycle",null),this._isDispatching=!1)})}register(t,e=""){const i=t;if(!i.id&&(i.id=e||n.Guid.getGuid()),this._storeHash[i.id])throw`A store with id ${i.id} already exists.`;this._storeHash[i.id]=i,this._stores.push(i),i.registerEventBus(this._eventBus),i.getStoreStateByToken=(t=>this._storeHash[t].getState())}subscribe(...t){const e=()=>{throw`subscribe function has no signature corresponding to the one you provided :\n      subscribe(${t.map(t=>typeof t).join(", ")}) => void; not found !`};0===t.length&&e(),"string"!=typeof t[0]&&e();let i=t.shift();if(0===this._stores.filter(t=>t.id===i).length)throw`Cannot subscribe to the store ${i}. This store does not exists or is not registered into the dispatcher.`;if(1===t.length){if("function"==typeof t[0])return this._eventBus.on(`${i}.updated`,e=>{(0,t[0])(e.getState())});e()}else if(2===t.length){if("function"==typeof t[0]&&"function"==typeof t[1])return this._eventBus.on(`${i}.updated`,e=>{const i=t[0];(0,t[1])(i(e.getState()))});if("string"==typeof t[0]&&"function"==typeof t[1]){const e=t[0];return this._eventBus.on(`${i}.updated.${e}`,e=>{(0,t[1])(e.getState())})}e()}else if(3===t.length){if("string"==typeof t[0]&&"function"==typeof t[1]&&"function"==typeof t[2]){const e=t[0];return this._eventBus.on(`${i}.updated.${e}`,e=>{const i=t[1];(0,t[2])(i(e.getState()))})}e()}else e()}unregister(t){this._stores=this._stores.filter(e=>e.id!==t.id),delete this._storeHash[t.id]}dispatch(t){this._payloads.push(t),!this._isDispatching&&this.processNextPayload()}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});class s{static generate2bytesNumber(){const t=Math.round(65535*Math.random());return[t,s.pad(t.toString(16),4)]}static generate4bytesNumber(){const t=Math.round(4294967295*Math.random());return[t,s.pad(t.toString(16),8)]}static generate6bytesNumber(){const t=Math.round(0xffffffffffff*Math.random());return[t,s.pad(t.toString(16),12)]}static pad(t,e){var i="";for(let t=0;t<e;t++)i+="0";return(i+t).substr(-e)}constructor(){const[t,e]=s.generate4bytesNumber(),[i,n]=s.generate2bytesNumber(),[r,o]=s.generate2bytesNumber(),[a,c]=s.generate2bytesNumber(),[u,h]=s.generate6bytesNumber();this._Guid_={part1:t,part2:i,part3:r,part4:a,part5:u,toString:`${e}-${n}-${o}-${c}-${h}`}}get part1(){return this._Guid_.part1}get part2(){return this._Guid_.part2}get part3(){return this._Guid_.part3}get part4(){return this._Guid_.part4}get part5(){return this._Guid_.part5}toString(){return this._Guid_.toString}static getGuid(){return(new s).toString()}}e.Guid=s},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.DefferedPromise=class{constructor(t){this.instance=null,this.executor=t}getPromise(){return this.instance||(this.instance=new Promise(this.executor)),this.instance}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.EventBus=class{constructor(t=".",e=3){this._Emitter_={oncePool:{},onPool:{},parent:void 0,Ids:0},""===t.trim()&&(t="."),e<1&&(e=1),this._separator=t,this._depthLevel=e}get _errors(){const t=this;return{get eventNameBadFormat(){return`The event name is not in the correct format :\nShould be in '${t._depthLevel}' part${t._depthLevel>1?"s":""}\n${t._depthLevel>1?"separated by '"+t._separator+"'":""}`}}}checkEventNameFormat(t){return t&&t.trim().length>0&&t.split(this._separator).length<=this._depthLevel||!1}get pools(){return[this._Emitter_.onPool,this._Emitter_.oncePool]}get separator(){return this._separator}set separator(t){""===t.trim()&&(t="."),this._separator=t}get parent(){return this._Emitter_.parent}set parent(t){this._Emitter_.parent=t}get depthLevel(){return this._depthLevel}set depthLevel(t){t<1&&(t=1),this._depthLevel=t}on(t,e){if(!this.checkEventNameFormat(t))throw Error(this._errors.eventNameBadFormat);this._Emitter_.onPool[t]||(this._Emitter_.onPool[t]=[]);let i={id:this._Emitter_.Ids++,callback:e};return this._Emitter_.onPool[t].push(i),this.emit("registerEvent",{eventName:t,callback:e}),{off:()=>this.off(i.id),id:i.id}}once(t,e){if(!this.checkEventNameFormat(t))throw Error(this._errors.eventNameBadFormat);this._Emitter_.oncePool[t]||(this._Emitter_.oncePool[t]=[]);let i={id:this._Emitter_.Ids++,callback:t=>{this.off(i.id),e(t)},originalCallback:e};return this._Emitter_.oncePool[t].push(i),this.emit("registerEvent",{eventName:t,callback:i.callback}),{off:()=>this.off(i.id),id:i.id}}off(...t){let e=void 0,i=void 0,s=void 0;if(0===t.length||!t)return this._Emitter_.oncePool={},void(this._Emitter_.onPool={});if(1===t.length)switch(typeof t[0]){case"string":e=t[0];break;case"number":s=t[0];break;default:i=t[0]}else e=t[0],i=t[1],s=t[2]||void 0;if(e&&"string"==typeof e){const t=e;this.pools.forEach(e=>{let s=e[t]||[];i&&(s=s.filter(t=>t.originalCallback?t.originalCallback===i:t.callback===i)),s.forEach(i=>{e[t]=e[t].filter(t=>t.id!==i.id)})})}else[this._Emitter_.onPool,this._Emitter_.oncePool].forEach(t=>{for(let e in t){let n=t[e];s&&(n=n.filter(t=>t.id===s)),i&&(n=n.filter(t=>t.originalCallback?t.originalCallback===i:t.callback===i)),n.forEach(i=>{t[e]=t[e].filter(t=>t.id!==i.id)})}})}emit(t,e){return"allEvents"!==t&&this.emit("allEvents",{eventName:t,data:e}),this.pools.forEach(i=>{for(const s in i)"string"==typeof s&&t.startsWith(s)&&i[s].forEach(t=>t.callback(e))}),this._Emitter_.parent&&this._Emitter_.parent.emit(t,e),!0}emitAsync(t,e){return setTimeout(()=>{this.pools.forEach(i=>{for(const s in i)"string"==typeof s&&t.startsWith(s)&&i[s].forEach(t=>t.callback(e))}),this._Emitter_.parent&&this._Emitter_.parent.emitAsync(t,e),"allEvents"!==t&&this.emitAsync("allEvents",{eventName:t,data:e})},0),!0}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.DispatcherCycle=class{constructor(t){this._events=[],this._cycleIndex=[],this._frameIndex=0,this._dispatcher=t}get length(){return this._cycleIndex.length}getFrameStartEnd(t){return[this._cycleIndex[t],(()=>this._cycleIndex[t+1]?this._cycleIndex[t+1]-1:this._events.length-1)()]}getFrameContent(t){return this._events.slice(...this.getFrameStartEnd(t))}get frameIndex(){return this._frameIndex}set frameIndex(t){this._frameIndex=t<this.length?t:this.length-1,this._frameIndex<0&&(this._frameIndex=0)}playCurrentFrame(){this.getFrameContent(this._frameIndex).filter(t=>"UpdatedState"===t.type).forEach(t=>{this._dispatcher._eventBus.emit(`${t.storeId}.setState`,t.storeState)})}newEvent(t,e){const i=t.split(".");"nextState"!==i[1]?"updated"!==i[1]?"dispatcher.newCycle"!==t?"dispatcher.endCycle"!==t?"dispatcher.dispatch"!==t?this._events.push({time:Date.now(),type:"NotProcessed",eventName:t,data:e}):this._events.push({time:Date.now(),type:"Dispatch",payload:e}):this._events.push({time:Date.now(),type:"EndCycle"}):this._cycleIndex.push(this._events.push({time:Date.now(),type:"NewCycle"})-1):this._events.push({time:Date.now(),type:"UpdatedState",storeId:i[0],fullEvent:t,storeState:e.getState()}):this._events.push({time:Date.now(),type:"NextState",storeId:i[0],storeState:e.getState()})}}},function(t,e,i){"use strict";var s=this&&this.__awaiter||function(t,e,i,s){return new(i||(i=Promise))(function(n,r){function o(t){try{c(s.next(t))}catch(t){r(t)}}function a(t){try{c(s.throw(t))}catch(t){r(t)}}function c(t){t.done?n(t.value):new i(function(e){e(t.value)}).then(o,a)}c((s=s.apply(t,e||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0});const n=i(14);e.BaseStore=class{constructor(){this.getStoreStateByToken=(()=>{}),this.id="",this.state={},this._eventBus=null,this._lockState=!1,this.initState(),this.actionStrategy=new n.BaseActionStrategy}registerEventBus(t){this._eventBus=t,this._eventBus.on(`${this.id}.lockState`,t=>{this._lockState=t}),this._eventBus.on(`${this.id}.setState`,t=>{this._lockState&&(this.state=t)})}emit(t=""){this._lockState||(""===t?t="updated":t.startsWith("updated")||(t=`updated.${t}`),this._eventBus&&this._eventBus.emit(`${this.id}.${t}`,this))}getState(){return this.state}nextState(t){this._lockState||(this.state="function"==typeof t?t(this.state):Object.assign({},this.state,t),this._eventBus&&this._eventBus.emit(`${this.id}.nextState`,this))}dispatchHandler(t,e,i,n){return s(this,void 0,void 0,function*(){return yield this.actionStrategy.resolve(this,t,e,i,n)})}}},function(t,e,i){"use strict";var s=this&&this.__awaiter||function(t,e,i,s){return new(i||(i=Promise))(function(n,r){function o(t){try{c(s.next(t))}catch(t){r(t)}}function a(t){try{c(s.throw(t))}catch(t){r(t)}}function c(t){t.done?n(t.value):new i(function(e){e(t.value)}).then(o,a)}c((s=s.apply(t,e||[])).next())})};Object.defineProperty(e,"__esModule",{value:!0});e.BaseActionStrategy=class{resolve(t,e,i,n,r){return s(this,void 0,void 0,function*(){if(`action${e.type}`in this)try{return yield t[`action${e.type}`](e,i,n,r)}catch(t){return t}else i()})}}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});e.Subscriber=class{constructor(t){this.dispatcher=t}subscribe(...t){return this.dispatcher.subscribe.apply(this.dispatcher,t)}sendAction(...t){2===t.length?this.dispatcher.dispatch(Object.assign({type:t[0]},t[1])):this.dispatcher.dispatch(t[0])}}}]);